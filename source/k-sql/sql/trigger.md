# 触发器

> 对触发器的支持是在 *MySQL 5* 中添加的。

如果你想要某条语句（或某些语句）在事件发生时自动执行，怎么办呢？例如：

* 每当增加一个顾客到某个数据库表时，都检查其电话号码格式是否正确；
* 每当订购一个产品时，都从库存数量中减去订购的数量；


所有这些例子的共同之处是它们都需要在某个表*发生更改时自动处理*。这确切地说就是触发器。触发器是 *MySQL* 响应以下任意语句而自动执行的一条 *MySQL* 语句（或位于 *BEGIN* 和 *END* 语句之间的一组语句）：

* delete
* insert
* update

而其他MySQL语句不支持触发器。

```{admonition} 仅支持表 
:class: tip

只有表才支持触发器，视图不支持（临时表也不支持）
```

触发器按每个表每个事件每次地定义，每个表每个事件每次只允许一个触发器。因此，每个表最多支持6个触发器（每条 *INSERT* 、 *UPDATE* 和 *DELETE* 的之前和之后）。单一触发器不能与多个事件或多个表关联，所以，如果你需要一个对 *INSERT* 和 *UPDATE* 操作执行的触发器，则应该定义两个触发器。

## 创建触发器

在创建触发器时，需要给出4条信息：

* 唯一的触发器名；
* 触发器关联的表；
* 触发器应该响应的活动（ *DELETE* 、 *INSERT* 或 *UPDATE* ）；
* 触发器何时执行（处理之前或之后）


```{admonition} 保持每个数据库的触发器名唯一 
:class: tip

在 *MySQL 5* 中，触发器名必须在每个表中唯一，但不是在每个数据库中唯一。这表示同一数据库中的两个表可具有相同名字的触发器。这在其他每个数据库触发器名必须唯一的DBMS中是不允许的，而且以后的 *MySQL* 版本很可能会使命名规则更为严格。因此，现在最好是在全部数据库范围内使用唯一的触发器名。
```

触发器用 `CREATE TRIGGER` 语句创建:



```{admonition} 触发器失败
:class: tip

如果 *BEFORE* 触发器失败，则 *MySQL* 将不执行请求的操作。此外，如果 *BEFORE* 触发器或语句本身失败， *MySQL* 将不执行 *AFTER* 触发器（如果有的话）
```

## 删除触发器

为了删除一个触发器，可使用 `DROP TRIGGER` 语句：

## insert 触发器



## delete 触发器



## update 触发器


